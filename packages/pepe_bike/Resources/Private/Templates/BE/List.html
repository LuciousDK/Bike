<f:layout name="Backend" />
<f:section name="Intro">
    <h1>
        Title
    </h1>
    <p>
        Introtext
    </p>
</f:section>
<f:section name="Content">
    <f:if condition="{f:count() -> bicycles} > 0">
        <f:then>

            <table class="table table-striped table-hover Datatables">
                <thead>
                    <tr>
                        <th>
                            Model
                        </th>
                        <th>
                            Hidden
                        </th>
                        <th>
                            Color
                        </th>
                        <th>
                            Wheels
                        </th>
                        <th>
                            Brand
                        </th>
                        <th>
                            Clients
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <f:for each="{bicycles}" as="bicycle">
                        <tr data-object-type="bicycle" data-object-uid="{bicycle.uid}">

                            <td data-object-property="model">
                                <f:link.action action="detail" arguments="{bicycleUid:bicycle.uid}">
                                    {bicycle.model}</f:link.action>
                                <a class="" href="#" data-action="edit"><span class="t3-icon fa fa-pencil"></span></a>
                            </td>

                            <f:variable name="hiddenString"
                                value="{f:if(condition: bicycle.hidden, then: ' checked', else: '')}" />
                            <td data-object-property="hidden">
                                <label class="switch">
                                    <input class="hidden-toggler"type="checkbox"{hiddenString}>
                                    <span class="slider"></span>
                                </label>
                            </td>

                            <td data-object-property="color">
                                {bicycle.color}
                                <a class="" href="#" data-action="edit"><span class="t3-icon fa fa-pencil"></span></a>
                            </td>

                            <td data-object-property="wheels">
                                {bicycle.wheels}
                                <a class="" href="#" data-action="edit"><span class="t3-icon fa fa-pencil"></span></a>
                            </td>
                            <td>
                                {bicycle.brand.name}
                            </td>

                            <f:variable name="clientString" value="" />
                            <f:if condition="{bicycle.clients}">
                                <f:for each="{bicycle.clients}" as="client" iteration="{iteration}">
                                    <f:variable name="clientString"
                                        value="{clientString}{client.firstName} {client.middleName} {client.lastName}" />
                                    <f:if condition="{iteration.isLast}">
                                        <f:else>
                                            <f:variable name="clientString" value="{clientString}, " />
                                        </f:else>
                                    </f:if>
                                </f:for>
                            </f:if>
                            <td>
                                <f:for each="{bicycle.clients}" as="client" iteration="iteration">
                                    {client.firstName} {client.middleName} {client.lastName}
                                </f:for>
                            </td>

                        </tr>
                    </f:for>
                </tbody>
            </table>

        </f:then>
    </f:if>
</f:section>
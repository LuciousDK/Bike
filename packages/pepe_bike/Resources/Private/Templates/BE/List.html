<f:layout name="Backend" />
<f:section name="Intro">
    <h1>
        Title
    </h1>
    <p>
        Introtext
    </p>
</f:section>
<f:section name="Content">
    <f:if condition="{f:count() -> bicycles} > 0">
        <f:then>

            <table class="table table-striped table-hover dataTables"
                data-columns='[{"type": "string"}, {"type": "string"}, {"type": "string"}, {"type": "num"}, {"type": "string"}, {"type": "string"}]'>
                <thead>
                    <tr>
                        <th>
                            Model
                        </th>
                        <th data-filter="true">
                            Hidden
                        </th>
                        <th data-filter="true">
                            Color
                        </th>
                        <th data-filter="true">
                            Wheels
                        </th>
                        <th data-filter="true">
                            Brand
                        </th>
                        <th data-filter="true">
                            Clients
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <f:for each="{bicycles}" as="bicycle">
                        <tr>

                            <td class="nowrap" data-search="{bicycle.model}" data-filter="{bicycle.model}">
                                <f:link.action action="detail" arguments="{bicycleUid:bicycle.uid}">
                                    {bicycle.model}</f:link.action>
                            </td>

                            <f:variable name="hiddenString"
                                value="{f:if(condition: bicycle.hidden, then: 'yes', else: 'no')}" />
                            <td class="nowrap" data-search="{hiddenString}" data-filter="{hiddenString}">
                                {hiddenString}
                            </td>

                            <td class="nowrap" data-search="{bicycle.color}" data-filter="{bicycle.color}">
                                {bicycle.color}
                            </td>

                            <td data-search="{bicycle.wheels}" data-filter="{bicycle.wheels}">
                                {bicycle.wheels}
                            </td>
                            <td data-search="{bicycle.brand}" data-filter="{bicycle.brand}">
                                {bicycle.brand.name}
                            </td>

                            <f:variable name="clientString" value="" />
                            <f:if condition="{bicycle.clients}">
                                <f:for each="{bicycle.clients}" as="client" iteration="{iteration}">
                                    <f:variable name="clientString"
                                        value="{clientString}{client.firstName} {client.middleName} {client.lastName}" />
                                    <f:if condition="{iteration.isLast}">
                                        <f:else>
                                            <f:variable name="clientString" value="{clientString}, " />
                                        </f:else>
                                    </f:if>
                                </f:for>
                            </f:if>
                            <td data-search="{clientString}" data-filter="{clientString}">
                                <f:for each="{bicycle.clients}" as="client" iteration="iteration">
                                    {client.firstName} {client.middleName} {client.lastName}
                                </f:for>
                            </td>

                        </tr>
                    </f:for>
                </tbody>
            </table>

        </f:then>
    </f:if>
</f:section>